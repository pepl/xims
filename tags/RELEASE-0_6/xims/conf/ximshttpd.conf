# XIMS-Config is loaded at Apache startup
<Locationmatch "^/goxims*">
    SetHandler perl-script
    PerlHandler goxims
    PerlAccessHandler Apache::AuthXIMS

    PerlSetVar ximsAuthStyle XIMS::Auth::Password
    # per default we are using passwords stored in the RDBMS for authentication
    #
    # we could also use an IMAP or LDAP server:
    # PerlSetVar ximsAuthStyle XIMS::Auth::IMAP

    # ximsAuthServer
    # has to be set for XIMS::Auth::IMAP and XIMS::Auth::LDAP
    # PerlSetVar ximsAuthServer imap_host

    # this has to be set for oracle
    #PerlSetEnv ORACLE_HOME path_to_your_oracle_home

    # set custom error-pages
    ErrorDocument 500 /ximspubroot/500.xsp
    ErrorDocument 403 /ximspubroot/access.xsp
    ErrorDocument 404 /ximspubroot/404.xsp


    # Add XSP taglibs here if you plan to use XIMS object type XSP
    AxAddXSPTaglib AxKit::XSP::Util
    AxAddXSPTaglib AxKit::XSP::Param
    AxAddXSPTaglib AxKit::XSP::IfParam
    AxAddXSPTaglib AxKit::XSP::WebUtils
    # AxDebugLevel 10
</Locationmatch>

    # For things like XIMS::AnonDiscussionForums for example, we may want to use
    # public-access to XIMS content. We use the special memberless role 'public'
    # for that. If your 'public' role is named differently at your XIMS installation,
    # you will have to change the value of ximsPublic accordingly.
    #
    # Public access will work only, if 'ximsPublic' is set and the PerlAccessHandler
    # Apache::AuthXIMS is not used in the config.

<Locationmatch "^/gopublic*">
    SetHandler perl-script
    PerlHandler goxims
    # we cannot use user-id here because with an ID of "0" undef is returned by dir_config()
    PerlSetVar ximsPublicUserName public
    PerlSetVar ximsgoxims /gopublic

    #PerlSetEnv ORACLE_HOME path_to_your_oracle_home

    ErrorDocument 500 /ximspubroot/500.xsp
    ErrorDocument 403 /ximspubroot/access.xsp
    ErrorDocument 404 /ximspubroot/404.xsp
    # AxDebugLevel 10
</Locationmatch>

<Locationmatch /ximspubroot/*>
    # adapt to your needs - '_ottereendex.html' is the default value of XIMS::Config::AutoIndexFilename()
    DirectoryIndex index.xsp index.pl index.cgi index.html index.htm index.xml _ottereendex.html
</Locationmatch>

<Location /ximspubroot/*.xsp>
    # sth works 'differently' regarding the Apache::Request object with SetHandler Axkit....
    # deactivated therefore for now
    #SetHandler AxKit
    AddType text/xml .xsp
    SetHandler perl-script
    PerlHandler AxKit

    AxResetProcessors
    AxGzipOutput On

    AxAddStyleMap application/x-xsp Apache::AxKit::Language::XSP
    AxAddStyleMap text/xsl Apache::AxKit::Language::LibXSLT

    AxErrorStylesheet text/xsl /ximspubroot/stylesheets/error.xsl

    AxAddPlugin Apache::AxKit::Plugin::AddXSLParams::Request
    PerlSetVar AxAddXSLParamGroups "Request-Common HTTPHeaders VerboseURI"

    AxAddProcessor application/x-xsp NULL
    AxAddProcessor text/xsl /ximspubroot/stylesheets/default.xsl

    AxAddXSPTaglib AxKit::XSP::Param
    AxAddXSPTaglib AxKit::XSP::IfParam
    AxAddXSPTaglib AxKit::XSP::WebUtils
    #  AxDebugLevel 10
</Location>


<Locationmatch "^/ximspubroot/.*\.html">
    SetHandler axkit

    AxAddStyleMap text/xsl Apache::AxKit::Language::LibXSLT
    AxErrorStylesheet text/xsl /ximspubroot/stylesheets/error.xsl

    AxAddPlugin Apache::AxKit::Plugin::Passthru
    AxAddPlugin Apache::AxKit::StyleChooser::UserAgent
    AxAddPlugin Apache::AxKit::StyleChooser::QueryString

    AxAddPlugin Apache::AxKit::Plugin::AddXSLParams::Request
    PerlSetVar AxAddXSLParamGroups "Request-Common HTTPHeaders"

    PerlSetVar AxUAStyleMap "#default => IE, textonly => Lynx"
    <AxMediaType screen>
        <AxStyleName "#default">
            AxAddProcessor text/xsl /ximspubroot/stylesheets/default.xsl
        </AxStyleName>
        <AxStyleName print>
            AxAddProcessor text/xsl /ximspubroot/stylesheets/default_print.xsl
        </AxStyleName>
        <AxStyleName textonly>
            AxAddProcessor text/xsl /ximspubroot/stylesheets/default_textonly.xsl
        </AxStyleName>
    </AxMediaType>
    #AxDebugLevel 5
</Locationmatch>

<Locationmatch "^/ximspubroot/.*\.axp">
    SetHandler axkit

    AxAddPlugin Apache::AxKit::Plugin::Passthru
    AxAddStyleMap application/x-axpoint Apache::AxKit::Language::AxPoint
    AxAddRootProcessor application/x-axpoint NULL slideshow

    #PerlSetVar AxTranslateOutput 1
    #PerlSetVar AxOutputCharset iso-8859-1
    #AxDebugLevel 5
</Locationmatch>

<Locationmatch "^/ximspubroot/.*\.sdbk">
    SetHandler axkit

    AxAddStyleMap text/xsl Apache::AxKit::Language::LibXSLT
    AxErrorStylesheet text/xsl /ximspubroot/stylesheets/error.xsl

    AxAddPlugin Apache::AxKit::Plugin::Passthru

    AxAddPlugin Apache::AxKit::Plugin::QueryStringCache
    AxAddPlugin Apache::AxKit::Plugin::AddXSLParams::Request
    PerlSetVar AxAddXSLParamGroups "Request-Common HTTPHeaders"

    AxAddProcessor text/xsl /ximspubroot/stylesheets/sdocbook_default.xsl
    #AxDebugLevel 5
</Locationmatch>

<Locationmatch "^/ximspubroot/.*\.xml">
    SetHandler axkit

    AxAddStyleMap text/xsl Apache::AxKit::Language::LibXSLT
    AxErrorStylesheet text/xsl /ximspubroot/stylesheets/error.xsl

    AxAddPlugin Apache::AxKit::Plugin::Passthru
    #AxDebugLevel 5
</Locationmatch>
