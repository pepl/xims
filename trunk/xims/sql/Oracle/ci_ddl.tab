-- Copyright (c) 2002-2008 The XIMS Project.
-- See the file "LICENSE" for information and conditions for use, reproduction,
-- and distribution of this work, and for a DISCLAIMER OF ALL WARRANTIES.
-- $Id$

PROMPT Creating Table 'CI_USERS_ROLES'
-- DROP TABLE CI_USERS_ROLES CASCADE CONSTRAINTS;
CREATE TABLE CI_USERS_ROLES
 (PASSWORD VARCHAR2(32)
 ,ENABLED NUMBER(1,0)
 ,ADMIN NUMBER(1,0)
 ,ID NUMBER(6,0) NOT NULL
 ,SYSTEM_PRIVS_MASK NUMBER(32,0) NOT NULL
 ,NAME VARCHAR2(30) NOT NULL
 ,LASTNAME VARCHAR2(90) NOT NULL
 ,MIDDLENAME VARCHAR2(30)
 ,FIRSTNAME VARCHAR2(90)
 ,EMAIL VARCHAR2(80)
 ,URL VARCHAR2(250)
 ,OBJECT_TYPE NUMBER(1,0) NOT NULL
 ,DAV_OTPRIVS_MASK NUMBER(32,0)
 )
/

COMMENT ON COLUMN CI_USERS_ROLES.OBJECT_TYPE IS '0 => user, 1 => role'
/

PROMPT Creating Table  'CI_USER_PREFS'
CREATE TABLE CI_USER_PREFS 
(
  ID NUMBER(6, 0) NOT NULL 
, PROFILE_TYPE VARCHAR2(20 BYTE) DEFAULT 'standard' NOT NULL 
, SKIN VARCHAR2(20 BYTE) DEFAULT 'default' NOT NULL 
, PUBLISH_AT_SAVE NUMBER(1, 0) DEFAULT 0 NOT NULL 
, CONTAINERVIEW_SHOW VARCHAR2(20 BYTE) DEFAULT 'title' NOT NULL 
)
LOGGING 
TABLESPACE "CI00_DAT" 
PCTFREE 10 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  MINEXTENTS 1 
  MAXEXTENTS 2147483645 
  BUFFER_POOL DEFAULT 
); 

PROMPT Creating Table 'CI_ROLES_GRANTED'
-- DROP TABLE CI_ROLES_GRANTED;
CREATE TABLE CI_ROLES_GRANTED
 (ID NUMBER NOT NULL
 ,GRANTOR_ID NUMBER NOT NULL
 ,GRANTEE_ID NUMBER NOT NULL
 ,ROLE_MASTER NUMBER(1,0)
 ,DEFAULT_ROLE NUMBER(1,0)
 )
/

COMMENT ON COLUMN CI_ROLES_GRANTED.ROLE_MASTER IS 'if 1, grantee has the right to manage role-membership of this role'
/
COMMENT ON COLUMN CI_ROLES_GRANTED.DEFAULT_ROLE IS 'will be used to specify the roles granted which are granted VIEW priv in setDefaultGrants'
/

PROMPT Creating Table 'CI_OBJECT_PRIVS_GRANTED'
-- DROP TABLE CI_OBJECT_PRIVS_GRANTED;
CREATE TABLE CI_OBJECT_PRIVS_GRANTED
 (PRIVILEGE_MASK NUMBER(32,0) NOT NULL
 ,GRANTEE_ID NUMBER NOT NULL
 ,GRANTOR_ID NUMBER NOT NULL
 ,CONTENT_ID NUMBER NOT NULL
 )
/

PROMPT Creating Table 'CI_DOCUMENTS'
-- DROP TABLE CI_DOCUMENTS CASCADE CONSTRAINTS;
CREATE TABLE CI_DOCUMENTS
 (LOCATION VARCHAR2(256)
 ,DOCUMENT_STATUS VARCHAR2(100)
 ,ID NUMBER NOT NULL
 ,PARENT_ID NUMBER
 ,OBJECT_TYPE_ID NUMBER NOT NULL
 ,DEPARTMENT_ID NUMBER DEFAULT 1
 ,DATA_FORMAT_ID NUMBER
 ,SYMNAME_TO_DOC_ID NUMBER
 ,POSITION NUMBER
 ,LOCATION_PATH VARCHAR2(4000)
 )
 STORAGE
 (
      INITIAL     1024000
      NEXT        1024000
      PCTINCREASE 0
      MINEXTENTS  1
      MAXEXTENTS  121
 )

/
COMMENT ON COLUMN CI_DOCUMENTS.POSITION IS 'For positioning in the parent_id container-context'
/
COMMENT ON COLUMN CI_DOCUMENTS.LOCATION_PATH IS 'Filled by ci_util.location_path* triggers on updates and inserts'
/


PROMPT Creating Table 'CI_CONTENT'
-- DROP TABLE CI_CONTENT CASCADE CONSTRAINTS;
CREATE TABLE CI_CONTENT
 (ID NUMBER NOT NULL
 ,DOCUMENT_ID NUMBER NOT NULL
 ,LANGUAGE_ID NUMBER
 ,TITLE VARCHAR2(400) NOT NULL
 ,KEYWORDS VARCHAR2(200)
 ,ABSTRACT VARCHAR2(2000)
 ,BINFILE BLOB 
 ,FILENAME_EXTERNAL VARCHAR2(512)
 ,BODY CLOB
 ,NOTES VARCHAR2(1000)
 ,MARKED_NEW NUMBER(1,0) NOT NULL
 ,DATA_FORMAT_NAME VARCHAR2(40)
 ,ATTRIBUTES VARCHAR2(256)
 ,STATUS VARCHAR2(100)
 ,STATUS_CHECKED_TIMESTAMP DATE
 ,VALID_FROM_TIMESTAMP DATE DEFAULT SYSDATE
 ,VALID_TO_TIMESTAMP DATE
 ,MARKED_DELETED NUMBER(1,0) NOT NULL
 ,DELETIONMARK_TIMESTAMP DATE                
 ,LAST_MODIFICATION_TIMESTAMP DATE DEFAULT SYSDATE NOT NULL
 ,LAST_MODIFIED_BY_ID NUMBER NOT NULL
 ,LAST_MODIFIED_BY_LASTNAME VARCHAR2(90)
 ,LAST_MODIFIED_BY_MIDDLENAME VARCHAR2(30)
 ,LAST_MODIFIED_BY_FIRSTNAME VARCHAR2(90)
 ,OWNED_BY_ID NUMBER NOT NULL
 ,OWNED_BY_LASTNAME VARCHAR2(90)
 ,OWNED_BY_MIDDLENAME VARCHAR2(30)
 ,OWNED_BY_FIRSTNAME VARCHAR2(90)
 ,CREATION_TIMESTAMP DATE DEFAULT SYSDATE NOT NULL
 ,CREATED_BY_ID NUMBER NOT NULL
 ,CREATED_BY_LASTNAME VARCHAR2(90)
 ,CREATED_BY_MIDDLENAME VARCHAR2(30)
 ,CREATED_BY_FIRSTNAME VARCHAR2(90)
 ,PUBLISHED NUMBER(1,0) NOT NULL
 ,LAST_PUBLICATION_TIMESTAMP DATE
 ,LAST_PUBLISHED_BY_ID NUMBER
 ,LAST_PUBLISHED_BY_LASTNAME VARCHAR2(90)
 ,LAST_PUBLISHED_BY_MIDDLENAME VARCHAR2(30)
 ,LAST_PUBLISHED_BY_FIRSTNAME VARCHAR2(90)
 ,LOCKED_TIME DATE  -- should be LOCKED_TIMESTAMP !!!
 ,LOCKED_BY_ID NUMBER
 ,LOCKED_BY_LASTNAME VARCHAR2(90)
 ,LOCKED_BY_MIDDLENAME VARCHAR2(30)
 ,LOCKED_BY_FIRSTNAME VARCHAR2(90)
 ,STYLE_ID NUMBER
 ,SCRIPT_ID NUMBER
 ,SCHEMA_ID NUMBER
 ,CSS_ID NUMBER
 ,IMAGE_ID NUMBER
 ,FEED_ID NUMBER 
 ,CONTENT_LENGTH NUMBER
 )
 PCTFREE    10
 PCTUSED    40
 INITRANS   1
 MAXTRANS   255
 STORAGE
 (
  INITIAL     10240000
  NEXT        10240000
  PCTINCREASE 0
  MINEXTENTS  1
  MAXEXTENTS  121
 )
/

COMMENT ON COLUMN CI_CONTENT.KEYWORDS IS 'values ";"-separated'
/

PROMPT Creating Table 'CI_DATA_FORMATS'
-- DROP TABLE CI_DATA_FORMATS CASCADE CONSTRAINTS;
CREATE TABLE CI_DATA_FORMATS
 (MIME_TYPE VARCHAR2(40) NOT NULL
 ,ID NUMBER NOT NULL
 ,NAME VARCHAR2(40) NOT NULL
 ,SUFFIX VARCHAR2(5)
 )
/

PROMPT Creating Table 'CI_LANGUAGES'
-- DROP TABLE CI_LANGUAGES CASCADE CONSTRAINTS;
CREATE TABLE CI_LANGUAGES
 (ID NUMBER NOT NULL
 ,CODE VARCHAR2(6) NOT NULL
 ,FULLNAME VARCHAR2(40) NOT NULL
 )
/

COMMENT ON COLUMN CI_LANGUAGES.CODE IS 'values: IANA-codes'
/

PROMPT Creating Table 'CI_OBJECT_TYPES'
-- DROP TABLE CI_OBJECT_TYPES CASCADE CONSTRAINTS;
CREATE TABLE CI_OBJECT_TYPES
 (ID NUMBER NOT NULL
 ,NAME VARCHAR2(40) NOT NULL
 ,IS_FS_CONTAINER NUMBER(1,0) DEFAULT 0
 ,IS_XIMS_DATA NUMBER(1,0) DEFAULT 0
 ,REDIR_TO_SELF NUMBER(1,0) DEFAULT 1
 ,PUBLISH_GOPUBLIC NUMBER(1,0) DEFAULT 0
 ,PARENT_ID NUMBER
 ,IS_OBJECTROOT NUMBER(1,0) DEFAULT 0
 ,IS_DAVGETABLE NUMBER(1,0) DEFAULT 0
 ,DAVPRIVVAL NUMBER(32,0)
 ,IS_MAILABLE NUMBER(1,0) DEFAULT 0
 )
/

COMMENT ON COLUMN CI_OBJECT_TYPES.IS_FS_CONTAINER IS 'IS_FS_CONTAINER indicates whether this object-type should be exported as folder to te filesystem'
COMMENT ON COLUMN CI_OBJECT_TYPES.REDIR_TO_SELF IS 'REDIR_TO_SELF indicates whether redirection after editing should go to the object self or to the parent object'
COMMENT ON COLUMN CI_OBJECT_TYPES.DAVPRIVVAL IS 'DAVPRIVVAL is used to determine the dav object type privileges for users (dav_otprivs_mask)'


